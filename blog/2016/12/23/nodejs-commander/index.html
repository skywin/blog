<!DOCTYPE html>
<html lang="zh-cn">
<head>
  <meta charset="UTF-8">
  <title>nodejs命令行管理模块commander | 邹成卓的个人网站</title>
  <meta name="viewport" content="width=device-width,height=device-height,user-scalable=0">
  <meta name="email" content="405966530@qq.com">
  <meta name="description" content="记得曾经写过一篇使用nodejs开发命令行程序的文章：http://zoucz.com/blog/2016/02/17/node-cmd-app/在这篇文章的demo文章中，我是这样管理命令行参数的：12345678910111213141516171819202122232425var cmd=p">
  <meta property="og:type" content="article">
  <meta property="og:title" content="nodejs命令行管理模块commander | 邹成卓的个人网站">
  <meta property="og:url" content="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/">
  <meta property="og:site_name" content="nodejs命令行管理模块commander">
  <meta property="og:description" content="记得曾经写过一篇使用nodejs开发命令行程序的文章：http://zoucz.com/blog/2016/02/17/node-cmd-app/在这篇文章的demo文章中，我是这样管理命令行参数的：12345678910111213141516171819202122232425var cmd=p">
  <link rel="shoticon" href="http://www.zoucz.com/favicon.ico" type="image/x-icon">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <meta name="renderer" content="webkit">
  <link href="http://www.zoucz.com/blogimgs/app-icon.png" rel="apple-touch-icon-precomposed">
  <link rel="alternate" type="application/rss+xml" href="http://www.zoucz.com/atom.xml" title="邹成卓的个人网站" />
  <link rel="stylesheet" href="/public/css/style.css?v=20151229" type="text/css">
  <script src="/public/js/jquery.js" type="text/javascript"></script>
  <script src="/public/js/main.js?v=20151229" type="text/javascript"></script>
</head>

<body>
    <div class="rainbow"></div>
    <div class="container">
  <div class="article" itemscope itemtype="http://schema.org/Article">
    <div class="post">
      <div class="post-title-wrapper">
        <h1 class="post-title" itemprop="name">nodejs命令行管理模块commander</h1>
        <a href="/entry/"><img src="/blogimgs/avatar150.png" alt="邹成卓" /></a>
      </div>
      <div class="post-info">
        <span>作者: <a href="/about/" itemprop="author">邹成卓</a></span>
        <span><time itemprop="timeCreated">2016-12-23 16:54:42</time></span>
        <span>分类: 
	<a class="category-link" href="/blog/categories/nodejs/">nodejs</a>

</span>
        <span>标签: 
<a class="article-tag-link" href="/blog/tags/nodejs/">nodejs</a>
</span>
        <span>评论数: <a href="#comments"
                      class="ds-thread-count hash-to-comments disqus-comment-count"
                      data-thread-key="nodejs-commander"
                      data-disqus-identifier="nodejs-commander"></a></span>
      </div>
      <div class="post-content" itemprop="articleBody">
        <div class="shit-spider" title="防爬虫不注明出处">
          <p>原文地址：<a href="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/">http://www.zoucz.com/blog/2016/12/23/nodejs-commander/</a>，<a href="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/#footer-nav-on">参与评论</a></p>
          <img src="http://www.zoucz.com/blogimgs/avatar150.png">
        </div>
        <p>记得曾经写过一篇使用nodejs开发命令行程序的文章：<a href="http://zoucz.com/blog/2016/02/17/node-cmd-app/" title="http://zoucz.com/blog/2016/02/17/node-cmd-app/" target="_blank" rel="external">http://zoucz.com/blog/2016/02/17/node-cmd-app/</a><br>在这篇文章的demo文章中，我是这样管理命令行参数的：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> cmd=process.argv[<span class="number">2</span>];</div><div class="line"><span class="keyword">if</span>(cmd)&#123;</div><div class="line">    <span class="keyword">switch</span>(cmd)&#123;</div><div class="line">        <span class="keyword">case</span> <span class="string">"name"</span>:</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"邹成卓"</span>);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">"site"</span>:</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"http://zoucz.com"</span>);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">        <span class="keyword">case</span> <span class="string">"email"</span>:</div><div class="line">            <span class="built_in">console</span>.log(<span class="string">"405966530@qq.com"</span>);</div><div class="line">            <span class="keyword">break</span>;</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="string">``</span><span class="string">`    </span></div><div class="line">当我们使用例如这样`node test01.js -b -p -P -c czzou<span class="string">`的命令来运行nodejs程序，在程序中可以通过`</span>process.argv<span class="string">`来获取请求参数，打印出这些参数，可以看到：    </span></div><div class="line">`<span class="built_in">console</span>.log(process.argv);<span class="string">`    </span></div><div class="line">`<span class="string">``</span>json</div><div class="line">[ <span class="string">'C:\\Program Files\\nodejs\\node.exe'</span>,</div><div class="line">  <span class="string">'D:\\learn\\nodejsLearn\\commanderLearn\\test01.js'</span>,</div><div class="line">  <span class="string">'-b'</span>,</div><div class="line">  <span class="string">'-p'</span>,</div><div class="line">  <span class="string">'-P'</span>,</div><div class="line">  <span class="string">'-c'</span>,</div><div class="line">  <span class="string">'czzou'</span> ]</div></pre></td></tr></table></figure></p>
<p>我们在命令行程序中需要解析这些命令来设置一些属性，执行一些操作，或者输出命令帮助信息等，每次自己去写一堆代码处理这些逻辑，每个人的方法还各自不同，是不是显得有点too young too native啊！<br>实际上nodejs社区里边已经有了比较成熟的命令行管理工具，例如我今天学的这一款：<a href="https://github.com/tj/commander.js" title="https://github.com/tj/commander.js" target="_blank" rel="external">https://github.com/tj/commander.js</a>，下面跟着官方示例来学习一下这个模块的用法。</p>
<h1 id="命令解析、参数解析"><a href="#命令解析、参数解析" class="headerlink" title="命令解析、参数解析"></a>命令解析、参数解析</h1><p>可以看看下面这个demo<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line"></div><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .option(<span class="string">'-p, --peppers'</span>, <span class="string">'Add peppers'</span>)</div><div class="line">  .option(<span class="string">'-P, --pineapple'</span>, <span class="string">'Add pineapple'</span>)</div><div class="line">  .option(<span class="string">'-b, --bbq-sauce'</span>, <span class="string">'Add bbq sauce'</span>)</div><div class="line">  .option(<span class="string">'-c, --cheese [type]'</span>, <span class="string">'Add the specified type of cheese [marble]'</span>, <span class="string">'marble'</span>)</div><div class="line">  .parse(process.argv);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">'you ordered a pizza with:'</span>);</div><div class="line"><span class="keyword">if</span> (program.peppers) <span class="built_in">console</span>.log(<span class="string">'  - peppers'</span>);</div><div class="line"><span class="keyword">if</span> (program.pineapple) <span class="built_in">console</span>.log(<span class="string">'  - pineapple'</span>);</div><div class="line"><span class="keyword">if</span> (program.bbqSauce) <span class="built_in">console</span>.log(<span class="string">'  - bbq'</span>);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'  - %s cheese'</span>, program.cheese);</div></pre></td></tr></table></figure></p>
<h2 id="version函数，设置版本号"><a href="#version函数，设置版本号" class="headerlink" title=".version函数，设置版本号"></a>.version函数，设置版本号</h2><p>接收一个字符串作为版本号，运行<code>node test01.js --version/-V</code>命令时，会在控制台中输出此版本号。    </p>
<h2 id="option函数，接收命令设置属性"><a href="#option函数，接收命令设置属性" class="headerlink" title=".option函数，接收命令设置属性"></a>.option函数，接收命令设置属性</h2><p>接收三个参数：接收命令，多个命令以逗号分隔、命令描述、命令参数默认值。<br><code>-c, --cheese [type]</code> 中括号括起来的属性代表此命令可以接收参数，如果命令不能接收参数，则受到此命令时，命令属性为true，否则为false，如果命令可以接收参数，则命令属性值为命令中输入的值。<br>这里注意：<strong>尖括号代表必须输入的命令参数，中括号代表可选的命令参数</strong></p>
<h2 id="parse函数"><a href="#parse函数" class="headerlink" title=".parse函数"></a>.parse函数</h2><p><code>.parse(process.argv)</code> 传入process.argv给commander模块以解析。</p>
<p>上面的demo以命令<code>node test01.js -b -p -P -c czzou</code>运行的结果：    </p>
<pre><code>- you ordered a pizza with:
- peppers
- pineapple
- bbq
- czzou cheese
</code></pre><h2 id="option函数命令参数Parse函数"><a href="#option函数命令参数Parse函数" class="headerlink" title="option函数命令参数Parse函数"></a>option函数命令参数Parse函数</h2><p>commander允许用户自行限制命令输入的参数类型，option函数的第三个参数可以用来传入一个函数来处理用户输入的命令，用法如下：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">range</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> val.split(<span class="string">'..'</span>).map(<span class="built_in">Number</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">val</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> val.split(<span class="string">','</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">collect</span>(<span class="params">val, memo</span>) </span>&#123;</div><div class="line">  memo.push(val);</div><div class="line">  <span class="keyword">return</span> memo;</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">increaseVerbosity</span>(<span class="params">v, total</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> total + <span class="number">1</span>;</div><div class="line">&#125;</div><div class="line"></div><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .usage(<span class="string">'[options] &lt;file ...&gt;'</span>)</div><div class="line">  .option(<span class="string">'-i, --integer &lt;n&gt;'</span>, <span class="string">'An integer argument'</span>, <span class="built_in">parseInt</span>)</div><div class="line">  .option(<span class="string">'-f, --float &lt;n&gt;'</span>, <span class="string">'A float argument'</span>, <span class="built_in">parseFloat</span>)</div><div class="line">  .option(<span class="string">'-r, --range &lt;a&gt;..&lt;b&gt;'</span>, <span class="string">'A range'</span>, range)</div><div class="line">  .option(<span class="string">'-l, --list &lt;items&gt;'</span>, <span class="string">'A list'</span>, list)</div><div class="line">  .option(<span class="string">'-o, --optional [value]'</span>, <span class="string">'An optional value'</span>)</div><div class="line">  .option(<span class="string">'-c, --collect [value]'</span>, <span class="string">'A repeatable value'</span>, collect, [])</div><div class="line">  .option(<span class="string">'-v, --verbose'</span>, <span class="string">'A value that can be increased'</span>, increaseVerbosity, <span class="number">0</span>)</div><div class="line">  .parse(process.argv);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">' int: %j'</span>, program.integer);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' float: %j'</span>, program.float);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' optional: %j'</span>, program.optional);</div><div class="line">program.range = program.range || [];</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' range: %j..%j'</span>, program.range[<span class="number">0</span>], program.range[<span class="number">1</span>]);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' list: %j'</span>, program.list);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' collect: %j'</span>, program.collect);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' verbosity: %j'</span>, program.verbose);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' args: %j'</span>, program.args);</div></pre></td></tr></table></figure></p>
<h2 id="通过正则表达式限定命令参数"><a href="#通过正则表达式限定命令参数" class="headerlink" title="通过正则表达式限定命令参数"></a>通过正则表达式限定命令参数</h2><p>除了传入函数来Parse参数，option函数还支持用正则表达式限定参数：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .option(<span class="string">'-s --size &lt;size&gt;'</span>, <span class="string">'Pizza size'</span>, /^(large|medium|small)$/i, <span class="string">'medium'</span>)</div><div class="line">  .option(<span class="string">'-d --drink [drink]'</span>, <span class="string">'Drink'</span>, /^(coke|pepsi|izze)$/i)</div><div class="line">  .parse(process.argv);</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log(<span class="string">' size: %j'</span>, program.size);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">' drink: %j'</span>, program.drink);</div></pre></td></tr></table></figure></p>
<h1 id="命令执行"><a href="#命令执行" class="headerlink" title="命令执行"></a>命令执行</h1><h2 id="命令执行函数"><a href="#命令执行函数" class="headerlink" title="命令执行函数"></a>命令执行函数</h2><p>通过command函数和action函数配合，可以做命令执行的功能：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .command(<span class="string">'rmdir'</span>)</div><div class="line">  .action(<span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'rmdir'</span>);</div><div class="line">  &#125;);</div><div class="line">program.parse(process.argv);</div></pre></td></tr></table></figure></p>
<p>这种方式即可定义一个rmdir命令，用户输入此命令之后执行传入.action函数的回调函数</p>
<h2 id="命令执行函数参数"><a href="#命令执行函数参数" class="headerlink" title="命令执行函数参数"></a>命令执行函数参数</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line"></div><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .command(<span class="string">'rmdir &lt;dir&gt; [otherDirs...]'</span>)</div><div class="line">  .action(<span class="function"><span class="keyword">function</span> (<span class="params">dir, otherDirs</span>) </span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'rmdir %s'</span>, dir);</div><div class="line">    <span class="keyword">if</span> (otherDirs) &#123;</div><div class="line">      otherDirs.forEach(<span class="function"><span class="keyword">function</span> (<span class="params">oDir</span>) </span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">'rmdir %s'</span>, oDir);</div><div class="line">      &#125;);</div><div class="line">    &#125;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">program.parse(process.argv);</div></pre></td></tr></table></figure>
<p>同上一节命令解析中的参数解析一样，执行命令时也可以传入参数，后边的<code>[otherDirs...]</code>表示一个可变参数，可以接收任意多个用户传入的参数。<br>输入命令：<code>node test02.js rmdir aaa bbb ccc</code>,得到结果：    </p>
<pre><code>- rmdir aaa
- rmdir bbb
- rmdir ccc
</code></pre><h2 id="子命令文件执行"><a href="#子命令文件执行" class="headerlink" title="子命令文件执行"></a>子命令文件执行</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line"></div><div class="line">program</div><div class="line">    .version(<span class="string">'0.0.1'</span>)</div><div class="line">    .command(<span class="string">'install [name]'</span>, <span class="string">'install one or more packages'</span>, &#123;<span class="attr">isDefault</span>: <span class="literal">true</span>&#125;)</div><div class="line">    .command(<span class="string">'search [query]'</span>, <span class="string">'search with optional query'</span>)</div><div class="line">    .command(<span class="string">'list'</span>, <span class="string">'list packages installed'</span>)</div><div class="line">    .parse(process.argv);</div></pre></td></tr></table></figure>
<p>这种情况，需要执行命令，还带有命令说明语句的，commander是不支持直接写上回调的！这里我觉得很奇怪，不知道为啥要这样设计。。。<br>官方推荐的做法是，在另一个文件中定义子命令：<br>例如，刚刚的文件名为 <code>pm.js</code> ，则在同级目录可新建一个文件 <code>pm-install.js</code>，用来执行install命令，其写法及参数接收方法为：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'commander'</span>);</div><div class="line"></div><div class="line">program</div><div class="line">    .option(<span class="string">'-f, --force'</span>, <span class="string">'force installation'</span>)</div><div class="line">    .parse(process.argv);</div><div class="line"></div><div class="line"><span class="keyword">var</span> pkgs = program.args;</div><div class="line"></div><div class="line"><span class="keyword">if</span> (!pkgs.length) &#123;</div><div class="line">    <span class="built_in">console</span>.error(<span class="string">'packages required'</span>);</div><div class="line">    process.exit(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="built_in">console</span>.log();</div><div class="line"><span class="keyword">if</span> (program.force) <span class="built_in">console</span>.log(<span class="string">'  force: install'</span>);</div><div class="line">pkgs.forEach(<span class="function"><span class="keyword">function</span>(<span class="params">pkg</span>)</span>&#123;</div><div class="line">    <span class="built_in">console</span>.log(<span class="string">'  install : %s'</span>, pkg);</div><div class="line">&#125;);</div><div class="line"><span class="built_in">console</span>.log();</div></pre></td></tr></table></figure></p>
<h1 id="设定命令格式，接收满足格式的命令"><a href="#设定命令格式，接收满足格式的命令" class="headerlink" title="设定命令格式，接收满足格式的命令"></a>设定命令格式，接收满足格式的命令</h1><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="meta">#!/usr/bin/env node</span></div><div class="line"></div><div class="line"><span class="keyword">var</span> program = <span class="built_in">require</span>(<span class="string">'../'</span>);</div><div class="line"></div><div class="line">program</div><div class="line">  .version(<span class="string">'0.0.1'</span>)</div><div class="line">  .arguments(<span class="string">'&lt;cmd&gt; [env]'</span>)</div><div class="line">  .action(<span class="function"><span class="keyword">function</span> (<span class="params">cmd, env</span>) </span>&#123;</div><div class="line">     cmdValue = cmd;</div><div class="line">     envValue = env;</div><div class="line">  &#125;);</div><div class="line"></div><div class="line">program.parse(process.argv);</div><div class="line"></div><div class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> cmdValue === <span class="string">'undefined'</span>) &#123;</div><div class="line">   <span class="built_in">console</span>.error(<span class="string">'no command given!'</span>);</div><div class="line">   process.exit(<span class="number">1</span>);</div><div class="line">&#125;</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'command:'</span>, cmdValue);</div><div class="line"><span class="built_in">console</span>.log(<span class="string">'environment:'</span>, envValue || <span class="string">"no environment given"</span>);</div></pre></td></tr></table></figure>
<p><img src="http://zoucz.com/blogimgs/2016-12-23/1482478048931.png" alt=""></p>
<h1 id="启用–harmony模式"><a href="#启用–harmony模式" class="headerlink" title="启用–harmony模式"></a>启用–harmony模式</h1><p>在低版本的nodejs上，若想启用es6的部分新特性，可以使用–harmony模式。 启用–harmony有两种方法：    </p>
<ul>
<li>文件首行加上 <code>#! /usr/bin/env node --harmony</code>    </li>
<li>使用这样的命令启动node程序 <code>node --harmony examples/pm publish</code>    </li>
</ul>
<h1 id="输出帮助信息"><a href="#输出帮助信息" class="headerlink" title="输出帮助信息"></a>输出帮助信息</h1><p>commander提供了自动输出帮助信息的能力：<br><code>xxx -h  或者  xxx --help</code>：<br><img src="http://zoucz.com/blogimgs/2016-12-23/1482483238087.png" alt=""></p>
<p>有此利器，用nodejs开发命令行程序那是简单又顺手啊 ：）</p>

        <p class="this-page-link">本文链接：<a href="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/">http://www.zoucz.com/blog/2016/12/23/nodejs-commander/</a></p>
        <p><a class="to-comments" href="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/#comments">☞ 参与评论</a></p>
      </div>
    </div>
    
    <div class="copyright" itemscope itemtype="http://schema.org/ProfilePage">
	<ul>
		<li>作者:  <a href="/about/" itemprop="name">邹成卓 (zoucz)</a></li>
		<li>发表日期:  2016-12-23 16:54:42</li>
		<li>文章分类: 
	<a class="category-link" href="/blog/categories/nodejs/">nodejs</a>

</li>
		<li>文章标签: 
<a class="article-tag-link" href="/blog/tags/nodejs/">nodejs</a>
</li>
		<li>版权声明: 自由转载-非商用-非衍生-保持署名（<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">创意共享3.0许可证</a>）</li>
		<li>最后编辑时间: 2016-12-23 16:54:42</li>
		<li>Feed订阅: <a href="/atom.xml"><i class="icon">&#x25c8;</i></a></li>
	</ul>
	<a href="/about/"><img src="/blogimgs/avatar150.png" /></a>
</div>
    <div class="share-article clearfix">
    
    <div class="ds-share" data-thread-key="nodejs-commander" data-title="nodejs命令行管理模块commander" data-images="" data-content="记得曾经写过一篇使用nodejs开发命令行程序的文章：http://zoucz.com/blog/2016/02/17/node-cmd-app/在这篇文章的demo文章中，我是这样管理命令行参数的：1234567891..." data-url="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/">
      <div class="ds-share-inline">
  <ul  class="ds-share-icons-16">
    <li data-toggle="ds-share-icons-more"><a class="ds-more" href="javascript:void(0);">分享到：</a></li>
    <li> <a class="ds-weibo" href="javascript:void(0);" data-service="weibo">新浪微博</a> </li>
    <li> <a class="ds-wechat" href="javascript:void(0);" data-service="wechat">微信</a> </li>
  </ul>
  <div class="ds-share-icons-more">
  </div>
</div>
    </div>
    </div>
    <em class="arrow-expend icon">&#xe618;
      <ul>
        <li><a href="/entry/">博客</a></li>
        <li><a href="/message/">留言</a></li>
        <li><a href="/about/">关于</a></li>
        <li><a href="/demo/">实验室</a></li>
        <li><a href="/comments/">最近评论</a></li>
        <li><a href="/friends/">友情链接</a></li>
      </ul>
    </em>
  </div>
  <div class="post-relative">
<div class="page-relative">
  
  
    <a href="/blog/2016/12/22/nodejs-pm2/" class="post-next">
      <b>nodejs进程管理工具pm2</b>
      <i class="icon">&#xe602;</i>
    </a>
  
</div>


<div class="page-relative-fixed">
  
  
  <a href="/blog/2016/12/22/nodejs-pm2/" class="next" title="nodejs进程管理工具pm2">
    <i class="icon">&#x261e;</i>
    <b>nodejs进程管理工具pm2</b>
  </a>
  
</div>
</div>
</div>
<div class="sidebar">
	<div class="func-btns func-btns-up">
    <span class="func-item">
        <i class="func-nav icon">&#xe618;<span>目录</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="javascript:void(0);" onclick="return false;">显示目录</a>
        </div>
    </span>
    <span class="func-item">
        <i class="func-font icon">&#xe604;<span>设置</span></i>
        <div class="font-choose-box">
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <div class="font-choose bg-choose">
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-sun font-type-song"><i class="icon">&#xe61a;</i></a>
            <a href="javascript:void(0)" onclick="return false;" class="bg-type bg-type-moon font-type-hei"><i class="icon">&#xe619;</i></a>
          </div>
          <div class="font-choose">
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-song">黑体</a>
            <a href="javascript:void(0)" onclick="return false;" class="font-type font-type-hei">宋体</a>
          </div>
        </div>
    </span>
    <span class="func-item">
        <a href="" target="_blank"><i class="func-fb icon">博<span>分享</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator sharecanvas"><a href="javascript: void(0);">截屏分享</a></p>
          <p><a href="" target="_blank">微博关注</a></p>
        </div>
    </span>
    <span class="func-item">
        <i class="func-about icon">&#x263b;<span>关于</span></i>
        <div>
          <i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p><a href="/about/" class="func-about-link" target="_blank">关于作者</a></p>
          <div id="followMeOnWeibo"></div>
        </div>
    </span>
	</div>
	<div class="func-btns">
    <span class="func-item">
        <a href="/" target="_blank"><i class="func-rss icon">&#xe603;<span>实验</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="/" target="_blank">Demo平台</a></p>
          <p><a href="/" target="_blank">Snippet应用</a></p>
        </div>
    </span>
    <span class="func-item">
        <i class="func-fb icon">&#x2121;<span>留言</span></i>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <p class="seperator"><a href="/message/" target="_blank">给我留言</a></p>
          <p><a href="/comments/" target="_blank">近期留言</a></p>
        </div>
    </span>
    <span class="func-item">
        <a href="/friends/" target="_blank"><i class="func-rss icon">&#xe601;<span>友链</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i>
          <a href="/friends/" target="_blank">友情链接</a>
        </div>
    </span>
    <span class="func-item">
        <a href="/atom.xml" target="_blank"><i class="func-rss icon">&#x25c8;<span>订阅</span></i></a>
        <div><i class="left-arrow"></i><i class="left-arrow-clone"></i><a href="/atom.xml" target="_blank">订阅我吧！</a></div>
    </span>
	</div>
</div>

<div class="single-page-footer">
<div class="footer">
	<div class="footer-wraper">
		<div class="footer-copostntent">
			<div class="footer-nav">
	<a href="javascript: void(0);" class="ds-thread-count disqus-comment-count"
	   data-thread-key="nodejs-commander"
	   data-disqus-identifier="nodejs-commander">评论内容</a>
	<a href="javascript: void(0);" id="footer-nav-on">相关文章</a>
	<a href="/friends">友情链接</a>
</div>
<div class="nav-detail">
	<div>
		



<div class="ds-thread" data-thread-key="nodejs-commander" data-title="nodejs命令行管理模块commander" data-url="http://www.zoucz.com/blog/2016/12/23/nodejs-commander/" data-name="zoucz">
	<div class="ds-loading">
		<img src="/blogimgs/loading.gif" alt="loading..."/>
		<p>这网速真是弱爆了...客官稍等,评论还在加载~</p>
	</div>
</div>





	</div>
	<div style="display:block;">
		<div class="relative-to-comment"><span>（点击评论）</span>古今多少事，都付笑谈中！</div>
		<div class="relative-wrapper">
	<div class="relative-article">
		
		<ul>
			<li>
				<span>2016-12-22 » </span><a href="/blog/2016/12/22/nodejs-pm2/">nodejs进程管理工具pm2</a>
				<div>nodejs存在的问题问题nodejs作为一种单线程、单进程运行的程序，如果只是简单的使用的话，存在...</div>
			</li>
			
			<li>
				<span>2016-08-02 » </span><a href="/blog/2016/08/02/nodejs-unittest-mochajs/">javascript单元测试框架mochajs详解</a>
				<div>关于单元测试的想法对于一些比较重要的项目，每次更新代码之后总是要自己测好久，担心一旦上线出了问题影响...</div>
			</li>
			
			<li>
				<span>2016-06-28 » </span><a href="/blog/2016/06/28/nodejs-get-time/">nodejs中获取时间戳、时间差</a>
				<div>Nodejs中获取时间戳的方法有很多种，例如：new Date().getTime()Date.no...</div>
			</li>
			
			<li>
				<span>2016-06-27 » </span><a href="/blog/2016/06/27/npm-shrinkwrap/">理解npm-shrinkwrap</a>
				<div>本文转自美团技术博客，原文：http://tech.meituan.com/npm-shrinkwr...</div>
			</li>
			
		</ul>
	</div>
</div>
		<a href="/entry/" class="relative-to-comment-wrapper"><div class="relative-to-comment">回到首页</div></a>
	</div>
	<div class="friends-box">
		<ul>
			
			<li><a href="h" target="_blank">小胡子哥的博客</a> » <span>0</span></li>
			
			<li><a href="/friends/">申请友链 »</a></li>
		</ul>
	</div>
</div>
			<div class="website-info">
	<!--<span>Copyright &copy;2013-2016 <small><a href="http://www.miitbeian.gov.cn/" about="_blank">湘ICP备14007107号-1</a></small></span>-->
	<a href="/about#contact">联系方式</a>
</div>
		</div>
	</div>
</div>
</div>
<div class="tools-wrapper">
	<a class="gotop icon" href="#" title="回到顶部">&#x2191;</a>
	<a class="wechart icon">&#xe60d;<span><img src="/wechart.png" title="扫码添加邹成卓微信"/> </span></a>
	<a class="hash-to-comments icon" title="我要评论">&#x2121;</a>
</div>
<div class="fixerr">纠错模式</div>
</body>
</html>